
/*********************************************************************************************************************************************************************************************
*********************************************************************************************************************************************************************************************
*********************************************************函数************************************************************************************************************************************
*********************************************************************************************************************************************************************************************
*********************************************************************************************************************************************************************************************
*******************************************************************************************************函数**************************************************************************************
*********************************************************************************************************************************************************************************************
*********************************************************************************************************************************************************************************************
***************************************************************函数**********************************************************************************************************
***********************************************************************************************************************************************函数**********************************************
*********************************************************************************************************************************************************************************************
********************************************************************函数*************************************************************************************************************************/
DELIMITER //
CREATE DEFINER=`root`@`%` FUNCTION `getParentRegion`(regionCode VARCHAR(64))
RETURNS varchar(1000) CHARSET utf8
	LANGUAGE SQL
	NOT DETERMINISTIC
	CONTAINS SQL
	SQL SECURITY DEFINER
	COMMENT ''
BEGIN

      DECLARE sParentList VARCHAR(1000);

      DECLARE sParentTemp VARCHAR(1000);

      SET sParentTemp =CAST(regionCode AS CHAR);

      WHILE sParentTemp IS NOT NULL DO

    IF (sParentList IS NOT NULL) THEN

         SET sParentList = CONCAT(sParentTemp,',',sParentList);

    ELSE

     SET sParentList = CONCAT(sParentTemp);

    END IF;

        SELECT GROUP_CONCAT(PARENT_REGION_CODE) INTO sParentTemp FROM ss_region WHERE FIND_IN_SET(REGION_CODE,sParentTemp)>0;

      END WHILE;

      RETURN sParentList;

END//
DELIMITER ;

/**************************************************************************************************************************************************************************************************
*********************************************************************************************************************************************************************************************
*********************************************************************************************************************************************************************************************
*******************************************************************************************存储过程**************************************************************************************************
*********************************************************************************************************************************************************************************************
*********************************************************************************************************************************************************************************************
***************************************************************存储过程****************************************************************************************************************
*****************************************************************************************************************存储过程****************************************************************************
*********************************************************************************************************************************************************************************************
*********************************************************************************************************************************************************************************************
********************************************************************************存储过程***************************************************存储过程**********************************************************
*********************************************************************************************************************************************************************************************
*********************************************************************************************************************************************************************************************/


/************************************************************************************************************************************************************************************************
**************************************触发器**********************************************************************************************************************************************************
************************************************************************************************************************************************************************************************
***************************************************************************************************************************触发器*********************************************************************
************************************************************************************************************************************************************************************************
****************************************触发器********************************************************************************************************************************************************
***************************************************************触发器************************************************************************************************************
************************************************************************************************************************************************************************************************
*******************************************************************************************************************************触发器*****************************************************************
************************************************************************************************************************************************************************************************
***************************************************触发器*********************************************************************************************************************************************
************************************************************************************************************************************************************************************************
******************************************************************************************触发器******************************************************************************************************/

/************************************************************************************************************************************************************************************************
**************************************索引**********************************************************************************************************************************************************
************************************************************************************************************************************************************************************************
***************************************************************************************************************************索引*********************************************************************
************************************************************************************************************************************************************************************************
****************************************索引********************************************************************************************************************************************************
***************************************************************索引************************************************************************************************************
************************************************************************************************************************************************************************************************
*******************************************************************************************************************************索引*****************************************************************
************************************************************************************************************************************************************************************************
***************************************************索引*********************************************************************************************************************************************
************************************************************************************************************************************************************************************************
******************************************************************************************索引******************************************************************************************************/

